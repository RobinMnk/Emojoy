{"ast":null,"code":"import _defineProperty from \"/Users/berzanmikaili/Developer/hackatum2019/hackaTUM2019/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/berzanmikaili/Developer/hackatum2019/hackaTUM2019/src/pages/Pong/Pong.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport Paddle from \"./components/paddle\";\nimport Ball from \"./components/ball\";\nimport Board from \"./components/board\";\nimport Waves from \"./components/waves\";\nimport { Row, Col } from 'antd';\nimport FaceAPI, { Emotion } from '../../components/faceapi';\nimport \"./Pong.css\";\n\nclass Pong extends Component {\n  constructor() {\n    super();\n\n    this.handleRoundStart = () => {\n      if (this.state.interval) return;\n      this.setState({\n        interval: setInterval(this.ballMove, 10),\n        isStarted: true\n      });\n    };\n\n    this.handlePlayerMove = () => {\n      let yPercent = 0;\n\n      if (this.state.keyPressed === \"down\") {\n        yPercent = this.state.playerY - 1;\n      } else if (this.state.keyPressed === \"up\") {\n        yPercent = this.state.playerY + 1;\n      }\n\n      if (yPercent <= 0) {\n        yPercent = 0;\n      } else if (yPercent > 80) {\n        yPercent = 80;\n      }\n\n      this.handleRoundStart();\n      this.setState({\n        playerY: yPercent\n      });\n    };\n\n    this.handleKeyDown = event => {\n      event.preventDefault();\n      let direction = \"\";\n\n      if (event.keyCode === 38) {\n        direction = \"down\";\n      } else if (event.keyCode === 40) {\n        direction = \"up\";\n      }\n\n      this.setState({\n        keyPressed: direction\n      }, this.handlePlayerMove);\n    };\n\n    this.handleSizeChange = event => {\n      const ball = _objectSpread({}, this.state.ball, {\n        radius: event.target.value / 10\n      });\n\n      this.setState({\n        ball: ball\n      });\n    };\n\n    this.ballMove = () => {\n      //opponent movement is also handled here\n      let _this$state$ball = this.state.ball,\n          radius = _this$state$ball.radius,\n          ballX = _this$state$ball.ballX,\n          ballY = _this$state$ball.ballY,\n          ballSpeedX = _this$state$ball.ballSpeedX,\n          ballSpeedY = _this$state$ball.ballSpeedY;\n      const radiusY = radius * window.innerWidth / window.innerHeight;\n      let _this$state = this.state,\n          playerY = _this$state.playerY,\n          opponentY = _this$state.opponentY;\n\n      if (ballX > 98 - radius - ballSpeedX) {\n        if (ballSpeedX > 0 && ballX > radius && ballY > opponentY - 2 * radius && ballY < opponentY + 20 + 2 * radius) {\n          if (ballY < opponentY - radius) {\n            this.cornerBounce();\n          } else if (ballY > opponentY + 20 + radius) {\n            this.cornerBounce(\"top\");\n          }\n\n          return this.BounceX(\"right\");\n        } else if (ballX > 100) {\n          return this.scorePoint(true);\n        }\n      } else if (ballX < 2 + radius - ballSpeedX) {\n        if (ballSpeedX < 0 && ballY > playerY - 2 * radius && ballY < playerY + 20 + 2 * radius) {\n          if (ballY < playerY - radius) {\n            this.cornerBounce(\"top\");\n          } else if (ballY > playerY + 20 + radius) {\n            this.cornerBounce();\n          }\n\n          return this.BounceX(\"left\");\n        } else if (ballX < 0 + ballSpeedX) {\n          return this.scorePoint();\n        }\n      }\n\n      if (ballSpeedY > 0 && ballY > 100 - radiusY - ballSpeedY || ballSpeedY < 0 && ballY < radiusY + ballSpeedY) {\n        return this.BounceY();\n      }\n\n      ballX += ballSpeedX;\n      ballY += ballSpeedY;\n\n      const ball = _objectSpread({}, this.state.ball, {}, {\n        ballX: ballX,\n        ballY: ballY\n      });\n\n      let opponentSpeed = Math.min(ballSpeedY * 0.8, 1.2);\n      opponentY += opponentSpeed;\n      if (opponentY < 0) opponentY = 0;else if (opponentY > 80) opponentY = 80;\n      this.setState({\n        ball: ball,\n        opponentY: opponentY\n      });\n    };\n\n    this.BounceY = () => {\n      this.animateBounce();\n\n      const ball = _objectSpread({}, this.state.ball, {\n        ballSpeedY: -this.state.ball.ballSpeedY\n      });\n\n      this.setState({\n        ball: ball\n      });\n    };\n\n    this.createWaves = side => {\n      const waves = this.state.waves.slice();\n      const paddleY = side === \"left\" ? this.state.playerY : this.state.opponentY;\n      const waveY = Math.min(paddleY + 20, Math.max(paddleY, this.state.ball.ballY));\n      const currentWave = {\n        waveY: waveY,\n        waveX: side === \"left\" ? 2 : 98,\n        intensity: Math.abs(this.state.ball.ballSpeedX) / 3\n      };\n      waves.push(currentWave);\n      this.setState({\n        waves: waves\n      });\n      setTimeout(() => {\n        waves.splice(waves.indexOf(currentWave), 1);\n        this.setState({\n          waves: waves\n        });\n      }, 300);\n    };\n\n    this.animateBounce = side => {\n      const _this$state$ball2 = this.state.ball,\n            ballSpeedX = _this$state$ball2.ballSpeedX,\n            ballSpeedY = _this$state$ball2.ballSpeedY;\n      const absSpeedX = Math.abs(ballSpeedX);\n      const absSpeedY = Math.abs(ballSpeedY);\n      const x = document.head.querySelector(\"#anim\");\n      if (x) x.remove(); //delete previous stylesheet with animation\n\n      let angle = absSpeedY * 3.14 * 57 / absSpeedX / 4; //arctan approximation to get the angle\n\n      angle = Math.min(angle, 60);\n\n      if (ballSpeedY > 0) {\n        if (ballSpeedX > 0) angle *= -1;\n      } else {\n        if (ballSpeedX < 0) angle *= -1;\n      }\n\n      let scale = Math.min(1 + absSpeedX / 4, 2); //stretch coefficient\n\n      const color = side === \"left\" ? \"purple\" : side === \"right\" ? \"#666600\" : \"#595959\";\n      const animId = ((ballSpeedX + ballSpeedY) * 100).toFixed(0); //generate unique animation name\n\n      const animSheet = document.createElement(\"style\");\n      animSheet.setAttribute(\"id\", \"anim\");\n      document.head.appendChild(animSheet);\n      animSheet.innerHTML = \"\\n      @keyframes bounce-animation\".concat(animId, \" {\\n        0% {\\n          transform: translate(-50%, -50%) rotate(0deg) scale(1, 1);\\n          background-color: black;\\n        }\\n        20% {\\n          transform: translate(-50%, -50%) rotate(\").concat(angle, \"deg) scale(\").concat(scale, \", \").concat(1 / scale, \");\\n          background-color: \").concat(color, \";\\n\\n        }\\n        100% {\\n          transform: translate(-50%, -50%) rotate(\").concat(angle, \"deg) scale(1, 1);\\n          background-color: black;\\n        }\\n      }\");\n      this.setState({\n        ball: _objectSpread({}, this.state.ball, {\n          animId: animId\n        })\n      });\n    };\n\n    this.BounceX = side => {\n      this.animateBounce(side);\n      this.createWaves(side);\n      const _this$state$ball3 = this.state.ball,\n            ballSpeedX = _this$state$ball3.ballSpeedX,\n            ballSpeedY = _this$state$ball3.ballSpeedY;\n      const newSpeedX = ballSpeedX * -1.05;\n      const newSpeedY = ballSpeedY + (side === \"left\" ? this.state.playerSpeed : ballSpeedY) / 20;\n\n      const ball = _objectSpread({}, this.state.ball, {}, {\n        ballSpeedX: newSpeedX,\n        ballSpeedY: newSpeedY\n      });\n\n      this.setState({\n        ball: ball,\n        animate: side === \"left\" ? [true, false] : [false, true]\n      });\n      setTimeout(() => {\n        this.setState({\n          animate: [false, false]\n        });\n      }, 300);\n    };\n\n    this.cornerBounce = up => {\n      const _this$state$ball4 = this.state.ball,\n            ballSpeedX = _this$state$ball4.ballSpeedX,\n            ballSpeedY = _this$state$ball4.ballSpeedY;\n      const speedChange = up ? ballSpeedX : -ballSpeedX;\n      this.setState({\n        ball: _objectSpread({}, this.state.ball, {}, {\n          ballSpeedX: ballSpeedX * 0.9,\n          ballSpeedY: ballSpeedY + speedChange\n        })\n      });\n    };\n\n    this.scorePoint = player => {\n      const score = this.state.score;\n      if (player) score[0]++;else score[1]++;\n      clearInterval(this.state.interval);\n\n      const ball = _objectSpread({}, this.state.ball, {}, {\n        ballX: 50,\n        ballY: 50,\n        ballSpeedX: 0.4 * Math.sign(Math.random() - 0.5),\n        ballSpeedY: Math.random() - 0.5,\n        animId: 0\n      });\n\n      this.setState({\n        //everything to initial, score updated\n        score: score,\n        interval: null,\n        ball: ball,\n        opponentY: 40\n      });\n    };\n\n    this.emotionChange = em => {\n      let direction = \"\";\n\n      if (em === 'surprised') {\n        direction = \"down\";\n      } else if (em === 'happy') {\n        direction = \"up\";\n      }\n\n      this.setState({\n        keyPressed: direction\n      }, this.handlePlayerMove);\n    };\n\n    this.state = {\n      animate: [false, false],\n      waves: [],\n      isStarted: false,\n      score: [0, 0],\n      playerY: 50,\n      opponentY: 40,\n      playerSpeed: 10,\n      interval: null,\n      keyPressed: \"\",\n      ball: {\n        animId: 0,\n        ballX: 50,\n        ballY: 50,\n        ballSpeedX: 0.4,\n        ballSpeedY: 0.2,\n        radius: 4\n      }\n    };\n  }\n\n  render() {\n    return React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }, React.createElement(Col, {\n      span: 16,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }, React.createElement(FaceAPI, {\n      setEmotion: em => this.emotionChange(em),\n      noCenter: true,\n      onRunning: () => alert(\"Done\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    })), React.createElement(Col, {\n      span: 16,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, React.createElement(\"main\", {\n      className: \"main\",\n      onKeyDown: this.handleKeyDown,\n      tabIndex: \"0\",\n      ref: \"main\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }, React.createElement(Board, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"score\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294\n      },\n      __self: this\n    }, this.state.score[0]), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }, this.state.score[1])), React.createElement(Paddle, {\n      animate: this.state.animate[0],\n      player: true,\n      pos: this.state.playerY,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }), React.createElement(Ball, {\n      ball: this.state.ball,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }), React.createElement(Paddle, {\n      animate: this.state.animate[1],\n      pos: this.state.opponentY,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }), React.createElement(Waves, {\n      waves: this.state.waves,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default Pong;","map":{"version":3,"sources":["/Users/berzanmikaili/Developer/hackatum2019/hackaTUM2019/src/pages/Pong/Pong.js"],"names":["React","Component","Paddle","Ball","Board","Waves","Row","Col","FaceAPI","Emotion","Pong","constructor","handleRoundStart","state","interval","setState","setInterval","ballMove","isStarted","handlePlayerMove","yPercent","keyPressed","playerY","handleKeyDown","event","preventDefault","direction","keyCode","handleSizeChange","ball","radius","target","value","ballX","ballY","ballSpeedX","ballSpeedY","radiusY","window","innerWidth","innerHeight","opponentY","cornerBounce","BounceX","scorePoint","BounceY","opponentSpeed","Math","min","animateBounce","createWaves","side","waves","slice","paddleY","waveY","max","currentWave","waveX","intensity","abs","push","setTimeout","splice","indexOf","absSpeedX","absSpeedY","x","document","head","querySelector","remove","angle","scale","color","animId","toFixed","animSheet","createElement","setAttribute","appendChild","innerHTML","newSpeedX","newSpeedY","playerSpeed","animate","up","speedChange","player","score","clearInterval","sign","random","emotionChange","em","render","alert"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Paddle from \"./components/paddle\";\nimport Ball from \"./components/ball\";\nimport Board from \"./components/board\";\nimport Waves from \"./components/waves\";\nimport { Row, Col } from 'antd';\nimport FaceAPI, { Emotion } from '../../components/faceapi';\nimport \"./Pong.css\";\n\nclass Pong extends Component {\n  constructor() {\n    super();\n    this.state = {\n      animate: [false, false],\n      waves: [],\n      isStarted: false,\n      score: [0, 0],\n      playerY: 50,\n      opponentY: 40,\n      playerSpeed: 10,\n      interval: null,\n      keyPressed: \"\",\n      ball: {\n        animId: 0,\n        ballX: 50,\n        ballY: 50,\n        ballSpeedX: 0.4,\n        ballSpeedY: 0.2,\n        radius: 4\n      }\n    };\n  }\n\n  handleRoundStart = () => {\n    if (this.state.interval) return;\n    this.setState({\n      interval: setInterval(this.ballMove, 10),\n      isStarted: true\n    });\n  };\n\n  handlePlayerMove = () => {\n    let yPercent = 0;\n    if (this.state.keyPressed === \"down\") {\n      yPercent = this.state.playerY - 1;\n    } else if (this.state.keyPressed === \"up\") {\n      yPercent = this.state.playerY + 1;\n    }\n    if (yPercent <= 0) {\n      yPercent = 0;\n    } else if (yPercent > 80) {\n      yPercent = 80;\n    }\n    this.handleRoundStart()\n    this.setState({\n      playerY: yPercent,\n    });\n  };\n\n  handleKeyDown = event => {\n    event.preventDefault()\n    let direction = \"\";\n    if (event.keyCode === 38) {\n      direction = \"down\";\n    } else if (event.keyCode === 40) {\n      direction = \"up\";\n    }\n    this.setState({\n      keyPressed: direction\n    }, this.handlePlayerMove);\n  }\n\n  handleSizeChange = event => {\n    const ball = { ...this.state.ball, radius: event.target.value / 10 };\n    this.setState({\n      ball: ball\n    });\n  };\n\n  ballMove = () => {\n    //opponent movement is also handled here\n    let { radius, ballX, ballY, ballSpeedX, ballSpeedY } = this.state.ball;\n    const radiusY = (radius * window.innerWidth) / window.innerHeight;\n    let { playerY, opponentY } = this.state;\n    if (ballX > 98 - radius - ballSpeedX) {\n      if (\n        ballSpeedX > 0 &&\n        ballX > radius &&\n        ballY > opponentY - 2*radius &&\n        ballY < opponentY + 20 + 2*radius\n      ) {\n        if (ballY < opponentY - radius) {\n          this.cornerBounce();\n        } else if (ballY > opponentY + 20 + radius) {\n          this.cornerBounce(\"top\");\n        }\n        return this.BounceX(\"right\");\n      } else if (ballX > 100) {\n        return this.scorePoint(true);\n      }\n    } else if (ballX < 2 + radius - ballSpeedX) {\n      if (\n        ballSpeedX < 0 &&\n        ballY > playerY - 2 * radius &&\n        ballY < playerY + 20 + 2 * radius\n      ) {\n        if (ballY < playerY - radius) {\n          this.cornerBounce(\"top\");\n        } else if (ballY > playerY + 20 + radius) {\n          this.cornerBounce();\n        }\n        return this.BounceX(\"left\");\n      } else if (ballX < 0 + ballSpeedX) {\n        return this.scorePoint();\n      }\n    }\n    if (\n      (ballSpeedY > 0 && ballY > 100 - radiusY - ballSpeedY) ||\n      (ballSpeedY < 0 && ballY < radiusY + ballSpeedY)\n    ) {\n      return this.BounceY();\n    }\n    ballX += ballSpeedX;\n    ballY += ballSpeedY;\n    const ball = { ...this.state.ball, ...{ ballX: ballX, ballY: ballY } };\n    let opponentSpeed = Math.min(ballSpeedY * 0.8, 1.2);\n    opponentY += opponentSpeed;\n    if (opponentY < 0) opponentY = 0;\n    else if (opponentY > 80) opponentY = 80;\n    this.setState({\n      ball: ball,\n      opponentY: opponentY,\n    });\n  };\n\n  BounceY = () => {\n    this.animateBounce();\n    const ball = {\n      ...this.state.ball,\n      ballSpeedY: -this.state.ball.ballSpeedY\n    };\n    this.setState({\n      ball: ball\n    });\n  };\n\n  createWaves = side => {\n    const waves = this.state.waves.slice();\n    const paddleY = side === \"left\" ? this.state.playerY : this.state.opponentY;\n    const waveY = Math.min(\n      paddleY + 20,\n      Math.max(paddleY, this.state.ball.ballY)\n    );\n    const currentWave = {\n      waveY: waveY,\n      waveX: side === \"left\" ? 2 : 98,\n      intensity: Math.abs(this.state.ball.ballSpeedX) / 3\n    };\n    waves.push(currentWave);\n    this.setState({\n      waves: waves\n    });\n\n    setTimeout(() => {\n      waves.splice(waves.indexOf(currentWave), 1);\n      this.setState({ waves: waves });\n    }, 300);\n  };\n\n  animateBounce = side => {\n    const { ballSpeedX, ballSpeedY } = this.state.ball;\n    const absSpeedX = Math.abs(ballSpeedX);\n    const absSpeedY = Math.abs(ballSpeedY);\n    const x = document.head.querySelector(\"#anim\");\n    if (x) x.remove(); //delete previous stylesheet with animation\n    let angle = (absSpeedY * 3.14 * 57) / absSpeedX / 4; //arctan approximation to get the angle\n    angle = Math.min(angle, 60);\n    if (ballSpeedY > 0) {\n      if (ballSpeedX > 0) angle *= -1;\n    } else {\n      if (ballSpeedX < 0) angle *= -1;\n    }\n    let scale = Math.min(1 + absSpeedX / 4, 2); //stretch coefficient\n    const color =\n      side === \"left\" ? \"purple\" : side === \"right\" ? \"#666600\" : \"#595959\";\n    const animId = ((ballSpeedX + ballSpeedY) * 100).toFixed(0); //generate unique animation name\n    const animSheet = document.createElement(\"style\");\n    animSheet.setAttribute(\"id\", \"anim\");\n    document.head.appendChild(animSheet);\n    animSheet.innerHTML = `\n      @keyframes bounce-animation${animId} {\n        0% {\n          transform: translate(-50%, -50%) rotate(0deg) scale(1, 1);\n          background-color: black;\n        }\n        20% {\n          transform: translate(-50%, -50%) rotate(${angle}deg) scale(${scale}, ${1 /\n      scale});\n          background-color: ${color};\n\n        }\n        100% {\n          transform: translate(-50%, -50%) rotate(${angle}deg) scale(1, 1);\n          background-color: black;\n        }\n      }`;\n    this.setState({\n      ball: { ...this.state.ball, animId: animId }\n    });\n  };\n  BounceX = side => {\n    this.animateBounce(side);\n    this.createWaves(side);\n    const { ballSpeedX, ballSpeedY } = this.state.ball;\n    const newSpeedX = ballSpeedX * -1.05;\n    const newSpeedY =\n      ballSpeedY + (side === \"left\" ? this.state.playerSpeed : ballSpeedY) / 20;\n    const ball = {\n      ...this.state.ball,\n      ...{ ballSpeedX: newSpeedX, ballSpeedY: newSpeedY }\n    };\n    this.setState({\n      ball: ball,\n      animate: side === \"left\" ? [true, false] : [false, true]\n    });\n    setTimeout(() => {\n      this.setState({ animate: [false, false] });\n    }, 300);\n  };\n\n  // TODO: If we want to remove speed change on corner remove it here\n  cornerBounce = up => {\n    const { ballSpeedX, ballSpeedY } = this.state.ball;\n    const speedChange = up ? ballSpeedX : -ballSpeedX;\n    this.setState({\n      ball: {\n        ...this.state.ball,\n        ...{\n          ballSpeedX: ballSpeedX * 0.9,\n          ballSpeedY: ballSpeedY + speedChange\n        }\n      }\n    });\n  };\n  scorePoint = player => {\n    const score = this.state.score;\n    if (player) score[0]++;\n    else score[1]++;\n    clearInterval(this.state.interval);\n    const ball = {\n      ...this.state.ball,\n      ...{ ballX: 50, ballY: 50, ballSpeedX: 0.4 * Math.sign(Math.random() -0.5), ballSpeedY: Math.random() -0.5, animId: 0 }\n    };\n    this.setState({\n      //everything to initial, score updated\n      score: score,\n      interval: null,\n      ball: ball,\n      opponentY: 40\n    });\n  };\n\n  emotionChange = em => {\n    let direction = \"\";\n    if (em === 'surprised') {\n      direction = \"down\";\n    } else if (em === 'happy') {\n      direction = \"up\";\n    }\n    this.setState({\n      keyPressed: direction\n    }, this.handlePlayerMove);\n  }\n\n  render() {\n    return (\n      <Row>\n        <Col span={16}>\n            <FaceAPI\n                setEmotion={em => this.emotionChange(em)}\n                noCenter={true}\n                onRunning={() => alert(\"Done\")}\n            />\n        </Col>\n        <Col span={16}>\n          <main\n            className=\"main\"\n            onKeyDown={this.handleKeyDown}\n            tabIndex=\"0\"\n            ref=\"main\"\n          >\n            <Board />\n            <div className=\"score\">\n              <span>{this.state.score[0]}</span>\n              <span>{this.state.score[1]}</span>\n            </div>\n            <Paddle\n              animate={this.state.animate[0]}\n              player={true}\n              pos={this.state.playerY}\n            />\n            <Ball ball={this.state.ball} />\n            <Paddle animate={this.state.animate[1]} pos={this.state.opponentY} />\n            <Waves waves={this.state.waves} />\n          </main>\n        </Col>\n      </Row>\n    );\n  }\n}\nexport default Pong;\n"]},"metadata":{},"sourceType":"module"}