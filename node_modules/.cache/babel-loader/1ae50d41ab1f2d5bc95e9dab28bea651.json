{"ast":null,"code":"import _defineProperty from \"/Users/berzanmikaili/Developer/hackatum2019/hackaTUM2019/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/berzanmikaili/Developer/hackatum2019/hackaTUM2019/src/pages/Pong/Pong.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport Paddle from \"./components/paddle\";\nimport Ball from \"./components/ball\";\nimport Options from \"./components/options\";\nimport Board from \"./components/board\";\nimport Waves from \"./components/waves\";\nimport \"./Pong.css\";\n\nclass Pong extends Component {\n  constructor() {\n    super();\n\n    this.handleRoundStart = () => {\n      if (this.state.interval) return;\n      this.setState({\n        interval: setInterval(this.ballMove, 10),\n        isStarted: true\n      });\n    };\n\n    this.handlePlayerMove = event => {\n      let yPercent = 0;\n      event.preventDefault();\n\n      if (event.keyCode === 38) {\n        yPercent = this.state.playerY - 1;\n      } else if (event.keyCode === 40) {\n        yPercent = this.state.playerY + 1;\n      }\n\n      this.setState({\n        playerY: yPercent\n      });\n    };\n\n    this.handleSizeChange = event => {\n      const ball = _objectSpread({}, this.state.ball, {\n        radius: event.target.value / 10\n      });\n\n      this.setState({\n        ball: ball\n      });\n    };\n\n    this.ballMove = () => {\n      //opponent movement is also handled here\n      let _this$state$ball = this.state.ball,\n          radius = _this$state$ball.radius,\n          ballX = _this$state$ball.ballX,\n          ballY = _this$state$ball.ballY,\n          ballSpeedX = _this$state$ball.ballSpeedX,\n          ballSpeedY = _this$state$ball.ballSpeedY;\n      const radiusY = radius * window.innerWidth / window.innerHeight;\n      let _this$state = this.state,\n          playerY = _this$state.playerY,\n          opponentY = _this$state.opponentY;\n\n      if (ballX > 98 - radius - ballSpeedX) {\n        if (ballSpeedX > 0 && ballX > radius && ballY > opponentY - 2 * radius && ballY < opponentY + 20 + 2 * radius) {\n          if (ballY < opponentY - radius) {\n            this.cornerBounce();\n          } else if (ballY > opponentY + 20 + radius) {\n            this.cornerBounce(\"top\");\n          }\n\n          return this.BounceX(\"right\");\n        } else if (ballX > 100) {\n          return this.scorePoint(true);\n        }\n      } else if (ballX < 2 + radius - ballSpeedX) {\n        if (ballSpeedX < 0 && ballY > playerY - 2 * radius && ballY < playerY + 20 + 2 * radius) {\n          if (ballY < playerY - radius) {\n            this.cornerBounce(\"top\");\n          } else if (ballY > playerY + 20 + radius) {\n            this.cornerBounce();\n          }\n\n          return this.BounceX(\"left\");\n        } else if (ballX < 0 + ballSpeedX) {\n          return this.scorePoint();\n        }\n      }\n\n      if (ballSpeedY > 0 && ballY > 100 - radiusY - ballSpeedY || ballSpeedY < 0 && ballY < radiusY + ballSpeedY) {\n        return this.BounceY();\n      }\n\n      ballX += ballSpeedX;\n      ballY += ballSpeedY;\n\n      const ball = _objectSpread({}, this.state.ball, {}, {\n        ballX: ballX,\n        ballY: ballY\n      });\n\n      let opponentSpeed = Math.min(ballSpeedY * 0.8, 1.2);\n      opponentY += opponentSpeed;\n      if (opponentY < 0) opponentY = 0;else if (opponentY > 80) opponentY = 80;\n      this.setState({\n        ball: ball,\n        opponentY: opponentY\n      });\n    };\n\n    this.BounceY = () => {\n      this.animateBounce();\n\n      const ball = _objectSpread({}, this.state.ball, {\n        ballSpeedY: -this.state.ball.ballSpeedY\n      });\n\n      this.setState({\n        ball: ball\n      });\n    };\n\n    this.createWaves = side => {\n      const waves = this.state.waves.slice();\n      const paddleY = side === \"left\" ? this.state.playerY : this.state.opponentY;\n      const waveY = Math.min(paddleY + 20, Math.max(paddleY, this.state.ball.ballY));\n      const currentWave = {\n        waveY: waveY,\n        waveX: side === \"left\" ? 2 : 98,\n        intensity: Math.abs(this.state.ball.ballSpeedX) / 3\n      };\n      waves.push(currentWave);\n      this.setState({\n        waves: waves\n      });\n      setTimeout(() => {\n        waves.splice(waves.indexOf(currentWave), 1);\n        this.setState({\n          waves: waves\n        });\n      }, 300);\n    };\n\n    this.animateBounce = side => {\n      const _this$state$ball2 = this.state.ball,\n            ballSpeedX = _this$state$ball2.ballSpeedX,\n            ballSpeedY = _this$state$ball2.ballSpeedY;\n      const absSpeedX = Math.abs(ballSpeedX);\n      const absSpeedY = Math.abs(ballSpeedY);\n      const x = document.head.querySelector(\"#anim\");\n      if (x) x.remove(); //delete previous stylesheet with animation\n\n      let angle = absSpeedY * 3.14 * 57 / absSpeedX / 4; //arctan approximation to get the angle\n\n      angle = Math.min(angle, 60);\n\n      if (ballSpeedY > 0) {\n        if (ballSpeedX > 0) angle *= -1;\n      } else {\n        if (ballSpeedX < 0) angle *= -1;\n      }\n\n      let scale = Math.min(1 + absSpeedX / 4, 2); //stretch coefficient\n\n      const color = side === \"left\" ? \"purple\" : side === \"right\" ? \"#666600\" : \"#595959\";\n      const animId = ((ballSpeedX + ballSpeedY) * 100).toFixed(0); //generate unique animation name\n\n      const animSheet = document.createElement(\"style\");\n      animSheet.setAttribute(\"id\", \"anim\");\n      document.head.appendChild(animSheet);\n      animSheet.innerHTML = \"\\n      @keyframes bounce-animation\".concat(animId, \" {\\n        0% {\\n          transform: translate(-50%, -50%) rotate(0deg) scale(1, 1);\\n          background-color: black;\\n        }\\n        20% {\\n          transform: translate(-50%, -50%) rotate(\").concat(angle, \"deg) scale(\").concat(scale, \", \").concat(1 / scale, \");\\n          background-color: \").concat(color, \";\\n\\n        }\\n        100% {\\n          transform: translate(-50%, -50%) rotate(\").concat(angle, \"deg) scale(1, 1);\\n          background-color: black;\\n        }\\n      }\");\n      this.setState({\n        ball: _objectSpread({}, this.state.ball, {\n          animId: animId\n        })\n      });\n    };\n\n    this.BounceX = side => {\n      this.animateBounce(side);\n      this.createWaves(side);\n      const _this$state$ball3 = this.state.ball,\n            ballSpeedX = _this$state$ball3.ballSpeedX,\n            ballSpeedY = _this$state$ball3.ballSpeedY;\n      const newSpeedX = ballSpeedX * -1.05;\n      const newSpeedY = ballSpeedY + (side === \"left\" ? this.state.playerSpeed : ballSpeedY) / 20;\n\n      const ball = _objectSpread({}, this.state.ball, {}, {\n        ballSpeedX: newSpeedX,\n        ballSpeedY: newSpeedY\n      });\n\n      this.setState({\n        ball: ball,\n        animate: side === \"left\" ? [true, false] : [false, true]\n      });\n      setTimeout(() => {\n        this.setState({\n          animate: [false, false]\n        });\n      }, 300);\n    };\n\n    this.cornerBounce = up => {\n      const _this$state$ball4 = this.state.ball,\n            ballSpeedX = _this$state$ball4.ballSpeedX,\n            ballSpeedY = _this$state$ball4.ballSpeedY;\n      const speedChange = up ? ballSpeedX : -ballSpeedX;\n      this.setState({\n        ball: _objectSpread({}, this.state.ball, {}, {\n          ballSpeedX: ballSpeedX * 0.9,\n          ballSpeedY: ballSpeedY + speedChange\n        })\n      });\n    };\n\n    this.scorePoint = player => {\n      const score = this.state.score;\n      if (player) score[0]++;else score[1]++;\n      clearInterval(this.state.interval);\n\n      const ball = _objectSpread({}, this.state.ball, {}, {\n        ballX: 50,\n        ballY: 50,\n        ballSpeedX: 0.4 * Math.sign(Math.random() - 0.5),\n        ballSpeedY: Math.random() - 0.5,\n        animId: 0\n      });\n\n      this.setState({\n        //everything to initial, score updated\n        score: score,\n        interval: null,\n        ball: ball,\n        opponentY: 40\n      });\n    };\n\n    this.state = {\n      animate: [false, false],\n      waves: [],\n      isStarted: false,\n      score: [0, 0],\n      playerY: 50,\n      opponentY: 40,\n      playerSpeed: 40,\n      interval: null,\n      ball: {\n        animId: 0,\n        ballX: 50,\n        ballY: 50,\n        ballSpeedX: 0.4,\n        ballSpeedY: 0.2,\n        radius: 4\n      }\n    };\n  }\n\n  render() {\n    return React.createElement(\"main\", {\n      className: \"main\",\n      onClick: this.handleRoundStart,\n      onKeyDown: this.handlePlayerMove,\n      tabIndex: \"0\",\n      ref: \"main\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(Board, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"score\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }, this.state.score[0]), !this.state.interval && React.createElement(\"span\", {\n      style: {\n        fontSize: \"30px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }, \"Left Click To Start\"), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, this.state.score[1])), !this.state.interval && React.createElement(Options, {\n      onSizeChange: this.handleSizeChange,\n      size: this.state.ball.radius,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }), React.createElement(Paddle, {\n      animate: this.state.animate[0],\n      player: true,\n      pos: this.state.playerY,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }), React.createElement(Ball, {\n      ball: this.state.ball,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }), React.createElement(Paddle, {\n      animate: this.state.animate[1],\n      pos: this.state.opponentY,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }), React.createElement(Waves, {\n      waves: this.state.waves,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Pong;","map":{"version":3,"sources":["/Users/berzanmikaili/Developer/hackatum2019/hackaTUM2019/src/pages/Pong/Pong.js"],"names":["React","Component","Paddle","Ball","Options","Board","Waves","Pong","constructor","handleRoundStart","state","interval","setState","setInterval","ballMove","isStarted","handlePlayerMove","event","yPercent","preventDefault","keyCode","playerY","handleSizeChange","ball","radius","target","value","ballX","ballY","ballSpeedX","ballSpeedY","radiusY","window","innerWidth","innerHeight","opponentY","cornerBounce","BounceX","scorePoint","BounceY","opponentSpeed","Math","min","animateBounce","createWaves","side","waves","slice","paddleY","waveY","max","currentWave","waveX","intensity","abs","push","setTimeout","splice","indexOf","absSpeedX","absSpeedY","x","document","head","querySelector","remove","angle","scale","color","animId","toFixed","animSheet","createElement","setAttribute","appendChild","innerHTML","newSpeedX","newSpeedY","playerSpeed","animate","up","speedChange","player","score","clearInterval","sign","random","render","fontSize"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Paddle from \"./components/paddle\";\nimport Ball from \"./components/ball\";\nimport Options from \"./components/options\";\nimport Board from \"./components/board\";\nimport Waves from \"./components/waves\";\nimport \"./Pong.css\";\n\nclass Pong extends Component {\n  constructor() {\n    super();\n    this.state = {\n      animate: [false, false],\n      waves: [],\n      isStarted: false,\n      score: [0, 0],\n      playerY: 50,\n      opponentY: 40,\n      playerSpeed: 40,\n      interval: null,\n      ball: {\n        animId: 0,\n        ballX: 50,\n        ballY: 50,\n        ballSpeedX: 0.4,\n        ballSpeedY: 0.2,\n        radius: 4\n      }\n    };\n  }\n\n  handleRoundStart = () => {\n    if (this.state.interval) return;\n    this.setState({\n      interval: setInterval(this.ballMove, 10),\n      isStarted: true\n    });\n  };\n\n  handlePlayerMove = event => {\n    let yPercent = 0\n    event.preventDefault();\n    if (event.keyCode === 38) {\n      yPercent = this.state.playerY - 1;\n    } else if (event.keyCode === 40) {\n      yPercent = this.state.playerY + 1;\n    }\n    this.setState({\n      playerY: yPercent,\n    });\n  };\n\n  handleSizeChange = event => {\n    const ball = { ...this.state.ball, radius: event.target.value / 10 };\n    this.setState({\n      ball: ball\n    });\n  };\n\n  ballMove = () => {\n    //opponent movement is also handled here\n    let { radius, ballX, ballY, ballSpeedX, ballSpeedY } = this.state.ball;\n    const radiusY = (radius * window.innerWidth) / window.innerHeight;\n    let { playerY, opponentY } = this.state;\n    if (ballX > 98 - radius - ballSpeedX) {\n      if (\n        ballSpeedX > 0 &&\n        ballX > radius &&\n        ballY > opponentY - 2*radius &&\n        ballY < opponentY + 20 + 2*radius\n      ) {\n        if (ballY < opponentY - radius) {\n          this.cornerBounce();\n        } else if (ballY > opponentY + 20 + radius) {\n          this.cornerBounce(\"top\");\n        }\n        return this.BounceX(\"right\");\n      } else if (ballX > 100) {\n        return this.scorePoint(true);\n      }\n    } else if (ballX < 2 + radius - ballSpeedX) {\n      if (\n        ballSpeedX < 0 &&\n        ballY > playerY - 2 * radius &&\n        ballY < playerY + 20 + 2 * radius\n      ) {\n        if (ballY < playerY - radius) {\n          this.cornerBounce(\"top\");\n        } else if (ballY > playerY + 20 + radius) {\n          this.cornerBounce();\n        }\n        return this.BounceX(\"left\");\n      } else if (ballX < 0 + ballSpeedX) {\n        return this.scorePoint();\n      }\n    }\n    if (\n      (ballSpeedY > 0 && ballY > 100 - radiusY - ballSpeedY) ||\n      (ballSpeedY < 0 && ballY < radiusY + ballSpeedY)\n    ) {\n      return this.BounceY();\n    }\n    ballX += ballSpeedX;\n    ballY += ballSpeedY;\n    const ball = { ...this.state.ball, ...{ ballX: ballX, ballY: ballY } };\n    let opponentSpeed = Math.min(ballSpeedY * 0.8, 1.2);\n    opponentY += opponentSpeed;\n    if (opponentY < 0) opponentY = 0;\n    else if (opponentY > 80) opponentY = 80;\n    this.setState({\n      ball: ball,\n      opponentY: opponentY,\n    });\n  };\n\n  BounceY = () => {\n    this.animateBounce();\n    const ball = {\n      ...this.state.ball,\n      ballSpeedY: -this.state.ball.ballSpeedY\n    };\n    this.setState({\n      ball: ball\n    });\n  };\n\n  createWaves = side => {\n    const waves = this.state.waves.slice();\n    const paddleY = side === \"left\" ? this.state.playerY : this.state.opponentY;\n    const waveY = Math.min(\n      paddleY + 20,\n      Math.max(paddleY, this.state.ball.ballY)\n    );\n    const currentWave = {\n      waveY: waveY,\n      waveX: side === \"left\" ? 2 : 98,\n      intensity: Math.abs(this.state.ball.ballSpeedX) / 3\n    };\n    waves.push(currentWave);\n    this.setState({\n      waves: waves\n    });\n\n    setTimeout(() => {\n      waves.splice(waves.indexOf(currentWave), 1);\n      this.setState({ waves: waves });\n    }, 300);\n  };\n\n  animateBounce = side => {\n    const { ballSpeedX, ballSpeedY } = this.state.ball;\n    const absSpeedX = Math.abs(ballSpeedX);\n    const absSpeedY = Math.abs(ballSpeedY);\n    const x = document.head.querySelector(\"#anim\");\n    if (x) x.remove(); //delete previous stylesheet with animation\n    let angle = (absSpeedY * 3.14 * 57) / absSpeedX / 4; //arctan approximation to get the angle\n    angle = Math.min(angle, 60);\n    if (ballSpeedY > 0) {\n      if (ballSpeedX > 0) angle *= -1;\n    } else {\n      if (ballSpeedX < 0) angle *= -1;\n    }\n    let scale = Math.min(1 + absSpeedX / 4, 2); //stretch coefficient\n    const color =\n      side === \"left\" ? \"purple\" : side === \"right\" ? \"#666600\" : \"#595959\";\n    const animId = ((ballSpeedX + ballSpeedY) * 100).toFixed(0); //generate unique animation name\n    const animSheet = document.createElement(\"style\");\n    animSheet.setAttribute(\"id\", \"anim\");\n    document.head.appendChild(animSheet);\n    animSheet.innerHTML = `\n      @keyframes bounce-animation${animId} {\n        0% {\n          transform: translate(-50%, -50%) rotate(0deg) scale(1, 1);\n          background-color: black;\n        }\n        20% {\n          transform: translate(-50%, -50%) rotate(${angle}deg) scale(${scale}, ${1 /\n      scale});\n          background-color: ${color};\n\n        }\n        100% {\n          transform: translate(-50%, -50%) rotate(${angle}deg) scale(1, 1);\n          background-color: black;\n        }\n      }`;\n    this.setState({\n      ball: { ...this.state.ball, animId: animId }\n    });\n  };\n  BounceX = side => {\n    this.animateBounce(side);\n    this.createWaves(side);\n    const { ballSpeedX, ballSpeedY } = this.state.ball;\n    const newSpeedX = ballSpeedX * -1.05;\n    const newSpeedY =\n      ballSpeedY + (side === \"left\" ? this.state.playerSpeed : ballSpeedY) / 20;\n    const ball = {\n      ...this.state.ball,\n      ...{ ballSpeedX: newSpeedX, ballSpeedY: newSpeedY }\n    };\n    this.setState({\n      ball: ball,\n      animate: side === \"left\" ? [true, false] : [false, true]\n    });\n    setTimeout(() => {\n      this.setState({ animate: [false, false] });\n    }, 300);\n  };\n\n  cornerBounce = up => {\n    const { ballSpeedX, ballSpeedY } = this.state.ball;\n    const speedChange = up ? ballSpeedX : -ballSpeedX;\n    this.setState({\n      ball: {\n        ...this.state.ball,\n        ...{\n          ballSpeedX: ballSpeedX * 0.9,\n          ballSpeedY: ballSpeedY + speedChange\n        }\n      }\n    });\n  };\n  scorePoint = player => {\n    const score = this.state.score;\n    if (player) score[0]++;\n    else score[1]++;\n    clearInterval(this.state.interval);\n    const ball = {\n      ...this.state.ball,\n      ...{ ballX: 50, ballY: 50, ballSpeedX: 0.4 * Math.sign(Math.random() -0.5), ballSpeedY: Math.random() -0.5, animId: 0 }\n    };\n    this.setState({\n      //everything to initial, score updated\n      score: score,\n      interval: null,\n      ball: ball,\n      opponentY: 40\n    });\n  };\n\n  render() {\n    return (\n      <main\n        className=\"main\"\n        onClick={this.handleRoundStart}\n        onKeyDown={this.handlePlayerMove}\n        tabIndex=\"0\"\n        ref=\"main\"\n      >\n        <Board />\n        <div className=\"score\">\n          <span>{this.state.score[0]}</span>\n          {!this.state.interval && (\n            <span style={{ fontSize: \"30px\" }}>Left Click To Start</span>\n          )}\n          <span>{this.state.score[1]}</span>\n        </div>\n        {!this.state.interval && (\n          <Options\n            onSizeChange={this.handleSizeChange}\n            size={this.state.ball.radius}\n          />\n        )}\n        <Paddle\n          animate={this.state.animate[0]}\n          player={true}\n          pos={this.state.playerY}\n        />\n        <Ball ball={this.state.ball} />\n        <Paddle animate={this.state.animate[1]} pos={this.state.opponentY} />\n        <Waves waves={this.state.waves} />\n      </main>\n    );\n  }\n}\nexport default Pong;\n"]},"metadata":{},"sourceType":"module"}